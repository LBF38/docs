"use strict";(self.webpackChunk_logto_docs=self.webpackChunk_logto_docs||[]).push([[1913],{49613:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(59496);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=a,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||o;return n?r.createElement(h,i(i({ref:t},p),{},{components:n})):r.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},67401:function(e,t,n){n.d(t,{Z:function(){return i}});n(59496);var r=n(45924),a="tabItem_Gmoj",o=n(4637);function i(e){var t=e.children,n=e.hidden,i=e.className;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.Z)(a,i),hidden:n,children:t})}},78926:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(59496),a=n(45924),o=n(65612),i=n(5400),s=n(30686),l=n(35132),u="tabList_Vvci",p="tabItem_rAYI",c=n(4637);function d(e){var t,n,o=e.lazy,d=e.block,m=e.defaultValue,h=e.values,k=e.groupId,f=e.className,g=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),y=null!=h?h:g.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),b=(0,i.l)(y,(function(e,t){return e.value===t.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var v=null===m?m:null!=(t=null!=m?m:null==(n=g.find((function(e){return e.props.default})))?void 0:n.props.value)?t:g[0].props.value;if(null!==v&&!y.some((function(e){return e.value===v})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+v+'" but none of its children has the corresponding value. Available values are: '+y.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var N=(0,s.U)(),w=N.tabGroupChoices,T=N.setTabGroupChoices,j=(0,r.useState)(v),A=j[0],I=j[1],x=[],P=(0,l.o5)().blockElementScrollPositionUntilNextRender;if(null!=k){var _=w[k];null!=_&&_!==A&&y.some((function(e){return e.value===_}))&&I(_)}var S=function(e){var t=e.currentTarget,n=x.indexOf(t),r=y[n].value;r!==A&&(P(t),I(r),null!=k&&T(k,String(r)))},C=function(e){var t,n=null;switch(e.key){case"ArrowRight":var r,a=x.indexOf(e.currentTarget)+1;n=null!=(r=x[a])?r:x[0];break;case"ArrowLeft":var o,i=x.indexOf(e.currentTarget)-1;n=null!=(o=x[i])?o:x[x.length-1]}null==(t=n)||t.focus()};return(0,c.jsxs)("div",{className:(0,a.Z)("tabs-container",u),children:[(0,c.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":d},f),children:y.map((function(e){var t=e.value,n=e.label,r=e.attributes;return(0,c.jsx)("li",Object.assign({role:"tab",tabIndex:A===t?0:-1,"aria-selected":A===t,ref:function(e){return x.push(e)},onKeyDown:C,onFocus:S,onClick:S},r,{className:(0,a.Z)("tabs__item",p,null==r?void 0:r.className,{"tabs__item--active":A===t}),children:null!=n?n:t}),t)}))}),o?(0,r.cloneElement)(g.filter((function(e){return e.props.value===A}))[0],{className:"margin-top--md"}):(0,c.jsx)("div",{className:"margin-top--md",children:g.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==A})}))})]})}function m(e){var t=(0,o.Z)();return(0,c.jsx)(d,Object.assign({},e),String(t))}},30319:function(e,t,n){n.r(t),n.d(t,{assets:function(){return w},contentTitle:function(){return v},default:function(){return A},frontMatter:function(){return b},metadata:function(){return N},toc:function(){return T}});var r=n(665),a=n(40151),o=(n(59496),n(49613)),i=n.p+"assets/images/create-api-resource-8a6f4c86fb1175ba6877f22e08b260bb.png",s=["components"],l={toc:[{value:"Get the JWK Public Key",id:"get-the-jwk-public-key",level:3}]};function u(e){var t=e.components,n=(0,a.Z)(e,s);return(0,o.kt)("wrapper",(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"get-the-jwk-public-key"},"Get the JWK Public Key"),(0,o.kt)("p",null,"All tokens issued by Logto are signed with ",(0,o.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc7517"},"JWK"),". (See ",(0,o.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc7515"},"JWS")," for more details)\nBefore moving on, you will need a public key to verify the signature of the Bearer Token (",(0,o.kt)("inlineCode",{parentName:"p"},"access_token"),")."),(0,o.kt)("p",null,"The key set can be inquired through Logto's ",(0,o.kt)("strong",{parentName:"p"},"jwks_uri"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"https://<your-logto-domain>/oidc/jwks"),"."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"All the latest Logto Authorization Server Configurations can be found by ",(0,o.kt)("inlineCode",{parentName:"p"},"https://<your-logto-domain>/oidc/.well-known/openid-configuration"),", including the ",(0,o.kt)("strong",{parentName:"p"},"jwks_uri")," and other authorization configs.")),(0,o.kt)("p",null,"As a response, you will get a JWKS (JSON Web Key Sets). ",(0,o.kt)("strong",{parentName:"p"},"Keep it")," on your server. You will need it to verify all the requests' token signatures."))}u.isMDXComponent=!0;var p=n(67401),c=n(78926),d=["components"],m={toc:[{value:"Validate the existence and extract the Bearer Token from Headers",id:"validate-the-existence-and-extract-the-bearer-token-from-headers",level:3}]};function h(e){var t=e.components,n=(0,a.Z)(e,d);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"validate-the-existence-and-extract-the-bearer-token-from-headers"},"Validate the existence and extract the Bearer Token from Headers"),(0,o.kt)("p",null,"The request should contain an ",(0,o.kt)("inlineCode",{parentName:"p"},"Authorization")," header with a ",(0,o.kt)("inlineCode",{parentName:"p"},"Bearer <access_token>")," format. Extract the Bearer Token from the request header:"),(0,o.kt)(c.Z,{mdxType:"Tabs"},(0,o.kt)(p.Z,{value:"js",label:"NodeJs",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { IncomingHttpHeaders } from 'http';\n\nconst extractBearerTokenFromHeaders = ({ authorization }: IncomingHttpHeaders) => {\n  if (!authorization) {\n    throw new Error({ code: 'auth.authorization_header_missing', status: 401 });\n  }\n\n  if (!authorization.startsWith('Bearer')) {\n    throw new Error({ code: 'auth.authorization_token_type_not_supported', status: 401 });\n  }\n\n  return authorization.slice(bearerTokenIdentifier.length + 1);\n};\n"))),(0,o.kt)(p.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'import javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.filter.OncePerRequestFilter;\n\n@Component\npublic class JwtRequestFilter extends OncePerRequestFilter {\n  @Override\n  protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n      final String requestTokenHeader = request.getHeader("Authorization");\n      String jwtToken = null;\n\n      if (requestTokenHeader != null && requestTokenHeader.startsWith("Bearer ")) {\n        jwtToken = requestTokenHeader.substring(7);\n      } else {\n        // No valid token found\n      }\n\n      // ...\n  }\n}\n\n'))),(0,o.kt)(p.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,o.kt)("p",null,"For python developers, there is a handy library ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/lepture/authlib"},"authlib")," that can easily help you validate the bearer token issued by Logto."),(0,o.kt)("p",null,"Create a resource protector for your private APIs:"),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"For Flask Developers please refer to the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.authlib.org/en/latest/flask/2/resource-server.html"},"flask_oauth resource_protector"),".\nFor Django Developers please check ",(0,o.kt)("a",{parentName:"p",href:"https://docs.authlib.org/en/latest/django/2/resource-server.html"},"django resource_protector"),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'from flask import Flask\n\n# For django developers:\nfrom authlib.integrations.django_oauth2 import ResourceProtector\n\n# For Flask Developers\nfrom authlib.integrations.flask_oauth2 import ResourceProtector\n\n# We will get back to this validator customization in the following validation section\nfrom validator import MyLogtoBearerTokenValidator\n\napp = Flask(__name__)\n\nrequire_auth = ResourceProtector()\nrequire_oauth.register_token_validator(MyLogtoBearerTokenValidator())\n\n@app.route("/api/foo")\n@require_auth()\ndef foo() # your protected API here\n\n')))))}h.isMDXComponent=!0;var k=["components"],f={toc:[{value:"Token Parse and Validation",id:"token-parse-and-validation",level:3}]};function g(e){var t=e.components,n=(0,a.Z)(e,k);return(0,o.kt)("wrapper",(0,r.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"token-parse-and-validation"},"Token Parse and Validation"),(0,o.kt)("p",null,"An encoded ",(0,o.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc7515"},"JWS")," token is constructed with three parts:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"JOSE Header: Declares the code type and encoding algorithm"),(0,o.kt)("li",{parentName:"ul"},"JWS Payload: Includes all the token's claims"),(0,o.kt)("li",{parentName:"ul"},"JWS Signature: Signature signed with JWK")),(0,o.kt)("p",null,"A standard schema of Logto JWS Payload: (claims may vary, based on your OIDC config)"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"key"),(0,o.kt)("th",{parentName:"tr",align:null},"description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"jti"),(0,o.kt)("td",{parentName:"tr",align:null},"unique JWT ID")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"sub"),(0,o.kt)("td",{parentName:"tr",align:null},"subject, usually user-id")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"iat"),(0,o.kt)("td",{parentName:"tr",align:null},"timestamp token issues at")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"exp"),(0,o.kt)("td",{parentName:"tr",align:null},"timestamp token expires at")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"client_id"),(0,o.kt)("td",{parentName:"tr",align:null},"application id")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"iss"),(0,o.kt)("td",{parentName:"tr",align:null},"token issuer identity")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"aud"),(0,o.kt)("td",{parentName:"tr",align:null},"audience of the token")))),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"For development, to visually inspect a JWT you could visit ",(0,o.kt)("a",{parentName:"p",href:"https://jwt.io/"},"jwt.io")," to decode and check the tokens you received. Be careful with the tokens from production env, as a third party provides the service, and your token may be toasted.")),(0,o.kt)("p",null,"The Bearer Token should be accepted only if:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"the token's JWS format is verified ( See ",(0,o.kt)("a",{parentName:"li",href:"https://datatracker.ietf.org/doc/html/rfc7519#section-7.2"},"JWT")," for more details)"),(0,o.kt)("li",{parentName:"ul"},"the token's issuer is ",(0,o.kt)("inlineCode",{parentName:"li"},"https://<your-logto-domain>/oidc")," (issued by the Logto server)"),(0,o.kt)("li",{parentName:"ul"},"the token's audience is the current API indicator (audience-restricted)"),(0,o.kt)("li",{parentName:"ul"},"the token is with in its valid lifetime")),(0,o.kt)("p",null,"There are various open-source libraries and middleware can help you validate the tokens easily. Most of them are implemented with just one method with various customizable configurations to verify and parse a JWT token."),(0,o.kt)(c.Z,{mdxType:"Tabs"},(0,o.kt)(p.Z,{value:"js",label:"NodeJs",mdxType:"TabItem"},(0,o.kt)("p",null,"Use ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/panva/jose"},"jose")," to validate the token's signature, expiration status, and the required claims."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { jwtVerify } from 'jose';\n\nconst { payload } = await jwtVerify(\n  token, // The raw Bearer Token extracted from the request header\n  publicKey, // jwks inquired from Logto server\n  {\n    // expected issuer of the token, should be (issued by the Logto server)\n    issuer: 'https://<your-logto-domain>/oidc',\n    // expected audience token, should be the resource indicator of the current API\n    audience: '<your request listener>',\n  }\n);\n"))),(0,o.kt)(p.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("p",null,"Use ",(0,o.kt)("a",{parentName:"p",href:"https://javadoc.io/doc/io.jsonwebtoken/jjwt/latest/index.html"},"io.jsonwebtoken")," package"),(0,o.kt)("p",null,"Add package dependency:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n  <groupId>io.jsonwebtoken</groupId>\n  <artifactId>jjwt</artifactId>\n  <version>0.9.1</version>\n</dependency>\n")),(0,o.kt)("p",null,"JwtTokenUtil:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"\nimport java.util.Date;\n\nimport io.jsonwebtoken.Claims;\nimport io.jsonwebtoken.Jwts;\n\npublic class JwtTokenUtil {\n\n    private final String secret;\n\n    public JwtTokenUtil(String secret) {\n        this.secret = secret;\n    }\n\n    public Boolean validateToken(String token, String listener, String logtoPath) {\n        final Claims claims = getAllClaimsFromToken(token);\n        final String audience = claims.getAudience();\n        final String issuer = claims.getIssuer();\n\n        return (audience.equals(listener) && issuer.equals(logtoPath) && !isTokenExpired(claims));\n    }\n\n    public Claims getAllClaimsFromToken(String token) {\n        return Jwts.parser().setSigningKey(secret).parseClaimsJws(token).getBody();\n    }\n\n    public Date getExpirationDateFromToken(String token) {\n        return getAllClaimsFromToken(token).getExpiration();\n    }\n\n    public String getUserIdFromToken(String token) {\n        return getAllClaimsFromToken(token).getSubject();\n    }\n\n    public String getAudienceFromToken(String token) {\n        return getAllClaimsFromToken(token).getAudience();\n    }\n\n    public String getIssuerFromToken(String token) {\n        return getAllClaimsFromToken(token).getIssuer();\n    }\n\n    private static Boolean isTokenExpired(Claims claims) {\n        return claims.getExpiration().before(new Date());\n    }\n}\n\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Package selections vary depending on the framework you are using.\nI.e., checkout ",(0,o.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/oauth2/jwt/package-summary.html"},"org.springframework.security.oauth2.jwt"),", if you use Spring Framework."))),(0,o.kt)(p.Z,{value:"python",label:"Python",mdxType:"TabItem"},(0,o.kt)("p",null,"Leverage authlib's ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/lepture/authlib/blob/169c7dcfc47478c8d55553cc95fb0f5578162b77/authlib/oauth2/rfc7523/validator.py"},"JWTBearerTokenValidator")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},'from authlib.oauth2.rfc7523 import JWTBearerTokenValidator\nfrom authlib.jose.rfc7517.jwk import JsonWebKey\n\nclass MyLogtoBearerTokenValidator(JWTBearerTokenValidator):\n    """\n    jwks: You will need to inquire the jwks from Logto\'s jwks endpoint: "https://<your-logto-domain>/oidc/jwks" and pass in the response\n    """\n    def __init__(self, jwks, issuer="https://<your-logto-domain>/oidc", audience):\n        public_key = JsonWebKey.import_key_set(jwks)\n        super(MyLogtoBearerTokenValidator, self).__init__(public_key, issuer)\n        self.claims_options = {\n           \'exp\': {\'essential\': True},\n           \'iss\': {\'essential\': True, \'value\': issuer}\n           \'aud\': {\'essential\': True, "value": audience} # Optional if you are using request url to validate the token audience\n        }\n\n    """\n    OPTIONAL: To guard the token audience more strictly at each endpoint level:\n    """\n    def validate_token(self, token, scopes, request):\n        super(MyLogtoBearerTokenValidator, self).validate_token(token, scopes, request)\n        if token.get(\'aud\') != str(request.url):\n            raise InvalidTokenError()\n\n')))))}g.isMDXComponent=!0;var y=["components"],b={sidebar_position:2},v="\u2694\ufe0f Protect your API",N={unversionedId:"docs/recipes/protect-your-api/README",id:"docs/recipes/protect-your-api/README",title:"\u2694\ufe0f Protect your API",description:"As an out-of-the-box authorization service, Logto allows you to apply authorization to your backend API resources for better privacy protection.",source:"@site/docs/docs/recipes/protect-your-api/README.mdx",sourceDirName:"docs/recipes/protect-your-api",slug:"/docs/recipes/protect-your-api/",permalink:"/docs/recipes/protect-your-api/",draft:!1,editUrl:"https://github.com/logto-io/docs/tree/master/docs/docs/recipes/protect-your-api/README.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docsSidebar",previous:{title:"Vue",permalink:"/docs/recipes/integrate-logto/vue"},next:{title:"Spring Boot",permalink:"/docs/recipes/protect-your-api/spring-boot"}},w={},T=[{value:"Register the API resources through Logto <strong>Admin Console</strong>",id:"register-the-api-resources-through-logto-admin-console",level:2},{value:"Parse and Validate the API request&#39;s authorization token",id:"parse-and-validate-the-api-requests-authorization-token",level:2},{value:"Reference",id:"reference",level:2}],j={toc:T};function A(e){var t=e.components,s=(0,a.Z)(e,y);return(0,o.kt)("wrapper",(0,r.Z)({},j,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\ufe0f-protect-your-api"},"\u2694\ufe0f Protect your API"),(0,o.kt)("p",null,"As an out-of-the-box authorization service, Logto allows you to apply authorization to your backend ",(0,o.kt)("a",{parentName:"p",href:"/docs/references/resources/"},"API resources")," for better privacy protection."),(0,o.kt)("h2",{id:"register-the-api-resources-through-logto-admin-console"},"Register the API resources through Logto ",(0,o.kt)("strong",{parentName:"h2"},"Admin Console")),(0,o.kt)("p",null,"First, you will need to register your backend endpoints in Admin Console. Logto will identify those registered ",(0,o.kt)("a",{parentName:"p",href:"/docs/references/resources/"},"API resources")," from an authorization request and grant an audience-restricted ",(0,o.kt)("inlineCode",{parentName:"p"},"access_token")," accordingly."),(0,o.kt)("p",null,"Go to the ",(0,o.kt)("strong",{parentName:"p"},"API Resources")," section in ",(0,o.kt)("strong",{parentName:"p"},"Admin Console"),". You will notice a build-in resource listed with the API identifier shown as ",(0,o.kt)("inlineCode",{parentName:"p"},"https://api.logto.io"),". This resource indicates all the management APIs of Logto. It guarantees all our APIs are under the protection and restricted to those Logto authorized users only."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"API resources",src:n(33038).Z,width:"1920",height:"964"})),(0,o.kt)("p",null,"Next, click on the ",(0,o.kt)("strong",{parentName:"p"},"Create API Resource")," button and fill out the form fields to register your private API resources:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A human-readable ",(0,o.kt)("strong",{parentName:"li"},"API Name")," that may better helps you to identify this entity."),(0,o.kt)("li",{parentName:"ul"},"A unique ",(0,o.kt)("strong",{parentName:"li"},"API Identifier")," (a.k.a. ",(0,o.kt)("a",{parentName:"li",href:"/docs/references/resources/#resource-indicator"},"Resource Indicator"),") in URI format. It represents the identity of the API resource.")),(0,o.kt)("img",{src:i,alt:"Create API resource",width:"700px"}),(0,o.kt)("br",null),(0,o.kt)("br",null),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"The API Identifier is unique and used as the single source of truth of the resource indicator for Logto. ",(0,o.kt)("strong",{parentName:"p"},"NOT")," editable once created. Be careful when you create it.")),(0,o.kt)("p",null,"The new API will show up on the list once created. You may manage or delete it at the API details page by clicking on the entity."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"API resource details",src:n(53817).Z,width:"1920",height:"956"})),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"/docs/references/resources/#logto-api-resource-schema"},"API Resource Logto Schema")," for detailed API setting definitions."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The API Resources data registered in Logto ",(0,o.kt)("strong",{parentName:"p"},"Admin Console")," will be shared across all your applications.")),(0,o.kt)("h2",{id:"parse-and-validate-the-api-requests-authorization-token"},"Parse and Validate the API request's authorization token"),(0,o.kt)("p",null,"The most crucial step, protect your API resources with trustworthy token validation."),(0,o.kt)("p",null,"As mentioned above, all the authorized requests should carry an ",(0,o.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc7519"},"JWT")," format ",(0,o.kt)("inlineCode",{parentName:"p"},"assess_token")," issued by Logto in its Authorization header."),(0,o.kt)(u,{mdxType:"SecretKey"}),(0,o.kt)(h,{mdxType:"TokenExtract"}),(0,o.kt)(g,{mdxType:"TokenValidation"}),(0,o.kt)("h2",{id:"reference"},"Reference"),(0,o.kt)("p",null,"Logto uses the code-based OAuth 2.0 Authorization Protocol to make your API request safer. If you are interested in the strategy behind it, refer to OAuth 2.0's ",(0,o.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc6749#section-1.3.1"},"official document")," for more details."))}A.isMDXComponent=!0},53817:function(e,t,n){t.Z=n.p+"assets/images/api-resource-details-5374ce9fe35f232dfc729570f4125c6c.png"},33038:function(e,t,n){t.Z=n.p+"assets/images/api-resources-381d558bded7d7a2949cee6250e42e40.png"}}]);